// Ù…Ù„Ù ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª - ÙÙ‚Ø· Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„
class VideoAdmin {
    constructor() {
        this.adminPassword = "perez123"; // ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
        this.isAuthenticated = false;
        this.videos = [];
        
        this.loadVideos();
        this.setupAdminPanel();
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ù† localStorage
    loadVideos() {
        const savedVideos = localStorage.getItem('perez_admin_videos');
        if (savedVideos) {
            this.videos = JSON.parse(savedVideos);
        }
    }
    
    // Ø­ÙØ¸ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
    saveVideos() {
        localStorage.setItem('perez_admin_videos', JSON.stringify(this.videos));
    }
    
    // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
    setupAdminPanel() {
        // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
        const adminBtn = document.createElement('button');
        adminBtn.id = 'adminToggle';
        adminBtn.innerHTML = 'ğŸ”';
        adminBtn.title = 'Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„';
        adminBtn.style.cssText = `
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 9999;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
            transition: all 0.3s ease;
        `;
        
        // ØªØ£Ø«ÙŠØ± Hover
        adminBtn.onmouseover = () => {
            adminBtn.style.transform = 'scale(1.1)';
            adminBtn.style.boxShadow = '0 6px 20px rgba(59, 130, 246, 0.6)';
        };
        
        adminBtn.onmouseout = () => {
            adminBtn.style.transform = 'scale(1)';
            adminBtn.style.boxShadow = '0 4px 12px rgba(59, 130, 246, 0.4)';
        };
        
        document.body.appendChild(adminBtn);
        
        adminBtn.addEventListener('click', () => this.toggleAdminPanel());
    }
    
    // Ø¹Ø±Ø¶/Ø¥Ø®ÙØ§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    toggleAdminPanel() {
        if (!this.isAuthenticated) {
            this.showLogin();
        } else {
            this.showAdminPanel();
        }
    }
    
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    showLogin() {
        const loginHTML = `
            <div class="admin-overlay">
                <div class="admin-modal">
                    <h2><i class="fas fa-lock"></i> Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h2>
                    <p>Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„ÙˆØµÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
                    <div class="form-group">
                        <input type="password" id="adminPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" class="admin-input" autocomplete="off">
                    </div>
                    <div class="admin-buttons">
                        <button id="loginBtn" class="admin-btn primary">
                            <i class="fas fa-sign-in-alt"></i> Ø¯Ø®ÙˆÙ„
                        </button>
                        <button id="cancelLogin" class="admin-btn secondary">
                            <i class="fas fa-times"></i> Ø¥Ù„ØºØ§Ø¡
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        const overlay = document.createElement('div');
        overlay.innerHTML = loginHTML;
        document.body.appendChild(overlay);
        
        // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ù‚Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        setTimeout(() => {
            const passInput = document.getElementById('adminPassword');
            if (passInput) passInput.focus();
        }, 100);
        
        // Ø­Ø¯Ø« Ø²Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„
        document.getElementById('loginBtn').addEventListener('click', () => {
            const password = document.getElementById('adminPassword').value;
            if (password === this.adminPassword) {
                this.isAuthenticated = true;
                overlay.remove();
                this.showAdminPanel();
            } else {
                alert('âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©!');
            }
        });
        
        // Ø­Ø¯Ø« Ø²Ø± Ø§Ù„Ø¥Ù„ØºØ§Ø¡
        document.getElementById('cancelLogin').addEventListener('click', () => {
            overlay.remove();
        });
        
        // Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
        document.getElementById('adminPassword').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('loginBtn').click();
            }
        });
    }
    
    // Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    showAdminPanel() {
        const panelHTML = `
            <div class="admin-overlay">
                <div class="admin-panel">
                    <div class="admin-header">
                        <h2><i class="fas fa-cogs"></i> Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h2>
                        <button id="closeAdmin" class="close-btn" title="Ø¥ØºÙ„Ø§Ù‚">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="admin-tabs">
                        <button class="tab-btn active" data-tab="add">
                            <i class="fas fa-plus-circle"></i> Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ
                        </button>
                        <button class="tab-btn" data-tab="manage">
                            <i class="fas fa-edit"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
                        </button>
                        <button class="tab-btn" data-tab="links">
                            <i class="fas fa-link"></i> Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
                        </button>
                    </div>
                    
                    <div class="tab-content active" id="addTab">
                        <h3><i class="fas fa-video"></i> Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯</h3>
                        <div class="form-group">
                            <label for="videoTitle"><i class="fas fa-heading"></i> Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</label>
                            <input type="text" id="videoTitle" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ" class="admin-input" autocomplete="off">
                        </div>
                        <div class="form-group">
                            <label for="videoUrl"><i class="fas fa-link"></i> Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (MP4)</label>
                            <input type="text" id="videoUrl" placeholder="https://example.com/video.mp4" class="admin-input" autocomplete="off">
                        </div>
                        <div class="form-group">
                            <label for="videoDesc"><i class="fas fa-align-left"></i> ÙˆØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</label>
                            <textarea id="videoDesc" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙØ§Ù‹ Ù„Ù„ÙÙŠØ¯ÙŠÙˆ..." class="admin-textarea" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="videoCategory"><i class="fas fa-list"></i> Ù‚Ø³Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</label>
                            <select id="videoCategory" class="admin-select">
                                <option value="Ø£ÙÙ„Ø§Ù… Ù‚ØµÙŠØ±Ø©">ğŸ¬ Ø£ÙÙ„Ø§Ù… Ù‚ØµÙŠØ±Ø©</option>
                                <option value="Ù…ÙˆØ³ÙŠÙ‚Ù‰">ğŸµ Ù…ÙˆØ³ÙŠÙ‚Ù‰</option>
                                <option value="Ø£Ù„Ø¹Ø§Ø¨">ğŸ® Ø£Ù„Ø¹Ø§Ø¨</option>
                                <option value="ØªØ¹Ù„ÙŠÙ…ÙŠØ©">ğŸ“š ØªØ¹Ù„ÙŠÙ…ÙŠØ©</option>
                                <option value="ÙƒÙˆÙ…ÙŠØ¯ÙŠØ§">ğŸ˜‚ ÙƒÙˆÙ…ÙŠØ¯ÙŠØ§</option>
                                <option value="Ø±ÙŠØ§Ø¶Ø©">âš½ Ø±ÙŠØ§Ø¶Ø©</option>
                            </select>
                        </div>
                        <button id="addVideoBtn" class="admin-btn primary">
                            <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                        </button>
                    </div>
                    
                    <div class="tab-content" id="manageTab">
                        <h3><i class="fas fa-film"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª <span class="badge">${this.videos.length}</span></h3>
                        <div class="videos-list" id="adminVideosList">
                            ${this.generateVideosList()}
                        </div>
                    </div>
                    
                    <div class="tab-content" id="linksTab">
                        <h3><i class="fas fa-paperclip"></i> Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©</h3>
                        <div class="links-container">
                            <p class="info-text"><i class="fas fa-info-circle"></i> Ù‡Ø°Ù‡ Ù‡ÙŠ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØªÙŠ Ø£Ø¶ÙØªÙ‡Ø§:</p>
                            <textarea id="videoLinks" class="links-textarea" readonly rows="10">${this.generateLinksList()}</textarea>
                            <div class="links-actions">
                                <button id="copyLinks" class="admin-btn primary">
                                    <i class="fas fa-copy"></i> Ù†Ø³Ø® Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
                                </button>
                                <button id="clearLinks" class="admin-btn secondary">
                                    <i class="fas fa-trash"></i> Ù…Ø³Ø­ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-footer">
                        <p><i class="fas fa-user-shield"></i> Ø£Ù†Øª Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… - ${this.videos.length} ÙÙŠØ¯ÙŠÙˆ</p>
                    </div>
                </div>
            </div>
        `;
        
        const overlay = document.createElement('div');
        overlay.innerHTML = panelHTML;
        document.body.appendChild(overlay);
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
        overlay.querySelector('.admin-panel').style.animation = 'slideUp 0.3s ease';
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        this.setupAdminEvents(overlay);
    }
    
    // ØªÙˆÙ„ÙŠØ¯ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
    generateVideosList() {
        if (this.videos.length === 0) {
            return `
                <div class="empty-state">
                    <i class="fas fa-video-slash"></i>
                    <h4>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª</h4>
                    <p>Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¨Ø¹Ø¯</p>
                </div>
            `;
        }
        
        return this.videos.map((video, index) => `
            <div class="admin-video-item" data-id="${video.id}">
                <div class="video-thumb">
                    <i class="fas fa-${video.thumbnail || 'video'}"></i>
                </div>
                <div class="video-info">
                    <h4>${video.title}</h4>
                    <p class="video-meta">
                        <span><i class="fas fa-tag"></i> ${video.category}</span>
                        <span><i class="far fa-calendar"></i> ${video.date}</span>
                        <span><i class="fas fa-eye"></i> ${video.views.toLocaleString()}</span>
                    </p>
                    <p class="video-desc">${video.description}</p>
                </div>
                <div class="video-actions">
                    <button class="action-btn preview" data-id="${video.id}" title="Ù…Ø¹Ø§ÙŠÙ†Ø©">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="action-btn delete" data-id="${video.id}" title="Ø­Ø°Ù">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
        `).join('');
    }
    
    // ØªÙˆÙ„ÙŠØ¯ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
    generateLinksList() {
        if (this.videos.length === 0) {
            return 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯.';
        }
        
        return this.videos.map((video, index) => 
            `${index + 1}. ${video.title}\n   ${video.url}`
        ).join('\n\n');
    }
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    setupAdminEvents(overlay) {
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù„ÙˆØ­Ø©
        document.getElementById('closeAdmin').addEventListener('click', () => {
            overlay.remove();
        });
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø¨Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„Ù„ÙˆØ­Ø©
        overlay.addEventListener('click', (e) => {
            if (e.target.classList.contains('admin-overlay')) {
                overlay.remove();
            }
        });
        
        // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
                btn.classList.add('active');
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„
                document.getElementById(btn.dataset.tab + 'Tab').classList.add('active');
            });
        });
        
        // Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯
        document.getElementById('addVideoBtn').addEventListener('click', () => {
            this.addNewVideo(overlay);
        });
        
        // Ù†Ø³Ø® Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
        document.getElementById('copyLinks').addEventListener('click', () => {
            const textarea = document.getElementById('videoLinks');
            textarea.select();
            textarea.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(textarea.value)
                .then(() => {
                    this.showToast('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!', 'success');
                })
                .catch(() => {
                    // Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø¯ÙŠÙ„Ø© Ù„Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
                    document.execCommand('copy');
                    this.showToast('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±ÙˆØ§Ø¨Ø·!', 'success');
                });
        });
        
        // Ù…Ø³Ø­ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
        document.getElementById('clearLinks').addEventListener('click', () => {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ØŸ')) {
                document.getElementById('videoLinks').value = '';
                this.showToast('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù…Ù† Ø§Ù„Ø­Ù‚Ù„', 'info');
            }
        });
        
        // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        overlay.addEventListener('click', (e) => {
            if (e.target.closest('.action-btn.preview')) {
                const videoId = e.target.closest('.action-btn').dataset.id;
                const video = this.videos.find(v => v.id == videoId);
                if (video) {
                    this.previewVideo(video);
                }
            }
        });
        
        // Ø­Ø°Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        overlay.addEventListener('click', (e) => {
            if (e.target.closest('.action-btn.delete')) {
                const videoId = e.target.closest('.action-btn').dataset.id;
                const video = this.videos.find(v => v.id == videoId);
                
                if (video && confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ "${video.title}"ØŸ`)) {
                    this.deleteVideo(videoId);
                    overlay.remove();
                    setTimeout(() => {
                        this.showAdminPanel();
                        this.showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    }, 300);
                }
            }
        });
        
        // Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
        document.getElementById('videoTitle').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('addVideoBtn').click();
            }
        });
    }
    
    // Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯
    addNewVideo(overlay) {
        const title = document.getElementById('videoTitle').value.trim();
        const url = document.getElementById('videoUrl').value.trim();
        const desc = document.getElementById('videoDesc').value.trim();
        const category = document.getElementById('videoCategory').value;
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
        if (!title) {
            this.showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ', 'error');
            document.getElementById('videoTitle').focus();
            return;
        }
        
        if (!url) {
            this.showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ', 'error');
            document.getElementById('videoUrl').focus();
            return;
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙŠØºØ© Ø§Ù„Ø±Ø§Ø¨Ø·
        if (!this.isValidVideoUrl(url)) {
            this.showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ ØµØ§Ù„Ø­ (MP4)', 'error');
            return;
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ù„Ø±Ø§Ø¨Ø·
        if (this.videos.some(v => v.url === url)) {
            this.showToast('Ù‡Ø°Ø§ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ø¶Ø§Ù Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'warning');
            return;
        }
        
        const newVideo = {
            id: Date.now(),
            title: title,
            url: url,
            description: desc || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ',
            category: category,
            date: new Date().toLocaleDateString('ar-EG', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            }),
            views: 0,
            likes: 0,
            thumbnail: this.getThumbnailByCategory(category)
        };
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        this.videos.unshift(newVideo);
        this.saveVideos();
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
        this.showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„
        document.getElementById('videoTitle').value = '';
        document.getElementById('videoUrl').value = '';
        document.getElementById('videoDesc').value = '';
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
        setTimeout(() => {
            overlay.remove();
            this.showAdminPanel();
        }, 1500);
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    isValidVideoUrl(url) {
        const videoExtensions = ['.mp4', '.webm', '.ogg', '.mov', '.avi'];
        return videoExtensions.some(ext => url.toLowerCase().endsWith(ext));
    }
    
    // Ø­Ø°Ù ÙÙŠØ¯ÙŠÙˆ
    deleteVideo(videoId) {
        this.videos = this.videos.filter(video => video.id != videoId);
        this.saveVideos();
    }
    
    // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    previewVideo(video) {
        const previewHTML = `
            <div class="preview-overlay">
                <div class="preview-modal">
                    <div class="preview-header">
                        <h3><i class="fas fa-play-circle"></i> ${video.title}</h3>
                        <button class="close-preview">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="preview-content">
                        <video controls class="preview-video">
                            <source src="${video.url}" type="video/mp4">
                            Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ.
                        </video>
                        <div class="preview-info">
                            <p><strong>Ø§Ù„Ù‚Ø³Ù…:</strong> ${video.category}</p>
                            <p><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${video.date}</p>
                            <p><strong>Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª:</strong> ${video.views.toLocaleString()}</p>
                            <p><strong>Ø§Ù„ÙˆØµÙ:</strong> ${video.description}</p>
                        </div>
                    </div>
                    <div class="preview-actions">
                        <a href="${video.url}" target="_blank" class="admin-btn primary">
                            <i class="fas fa-external-link-alt"></i> ÙØªØ­ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©
                        </a>
                        <button class="admin-btn secondary close-preview">
                            <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        const previewOverlay = document.createElement('div');
        previewOverlay.innerHTML = previewHTML;
        document.body.appendChild(previewOverlay);
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
        previewOverlay.querySelectorAll('.close-preview').forEach(btn => {
            btn.addEventListener('click', () => {
                previewOverlay.remove();
            });
        });
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ESC
        document.addEventListener('keydown', function closeOnEscape(e) {
            if (e.key === 'Escape') {
                previewOverlay.remove();
                document.removeEventListener('keydown', closeOnEscape);
            }
        });
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ
    getThumbnailByCategory(category) {
        const icons = {
            'Ø£ÙÙ„Ø§Ù… Ù‚ØµÙŠØ±Ø©': 'film',
            'Ù…ÙˆØ³ÙŠÙ‚Ù‰': 'music',
            'Ø£Ù„Ø¹Ø§Ø¨': 'gamepad',
            'ØªØ¹Ù„ÙŠÙ…ÙŠØ©': 'graduation-cap',
            'ÙƒÙˆÙ…ÙŠØ¯ÙŠØ§': 'laugh',
            'Ø±ÙŠØ§Ø¶Ø©': 'basketball-ball'
        };
        return icons[category] || 'video';
    }
    
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© toast
    showToast(message, type = 'info') {
        // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ toast Ø³Ø§Ø¨Ù‚
        const oldToast = document.querySelector('.toast-message');
        if (oldToast) oldToast.remove();
        
        const toast = document.createElement('div');
        toast.className = `toast-message toast-${type}`;
        toast.innerHTML = `
            <div class="toast-content">
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            </div>
        `;
        
        document.body.appendChild(toast);
        
        // Ø¥Ø¸Ù‡Ø§Ø± Toast
        setTimeout(() => {
            toast.classList.add('show');
        }, 10);
        
        // Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 300);
        }, 3000);
    }
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
let videoAdmin;

document.addEventListener('DOMContentLoaded', () => {
    // Ø¥Ø¶Ø§ÙØ© ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù€ Toast
    const toastStyles = document.createElement('style');
    toastStyles.textContent = `
        .toast-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #1e293b;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 4px solid #3b82f6;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 10001;
            max-width: 350px;
        }
        
        .toast-message.show {
            transform: translateX(0);
        }
        
        .toast-success {
            border-left-color: #10b981;
        }
        
        .toast-error {
            border-left-color: #ef4444;
        }
        
        .toast-warning {
            border-left-color: #f59e0b;
        }
        
        .toast-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .toast-content i {
            font-size: 18px;
        }
        
        .toast-success .toast-content i {
            color: #10b981;
        }
        
        .toast-error .toast-content i {
            color: #ef4444;
        }
        
        .toast-warning .toast-content i {
            color: #f59e0b;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© */
        .preview-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 10002;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }
        
        .preview-modal {
            background: #1e293b;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            border: 1px solid rgba(59, 130, 246, 0.3);
            animation: slideUp 0.3s ease;
        }
        
        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .preview-header h3 {
            color: #3b82f6;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-preview {
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .close-preview:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .preview-content {
            padding: 20px;
        }
        
        .preview-video {
            width: 100%;
            border-radius: 10px;
            background: #000;
            margin-bottom: 20px;
        }
        
        .preview-info {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 10px;
        }
        
        .preview-info p {
            margin: 5px 0;
            color: #cbd5e1;
        }
        
        .preview-actions {
            display: flex;
            gap: 15px;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .preview-actions .admin-btn {
            flex: 1;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .badge {
            background: #3b82f6;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #94a3b8;
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #475569;
        }
        
        .admin-footer {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
            text-align: center;
            color: #94a3b8;
            font-size: 14px;
        }
        
        .admin-footer i {
            margin-right: 5px;
        }
        
        .info-text {
            color: #94a3b8;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .links-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    `;
    document.head.appendChild(toastStyles);
    
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
    videoAdmin = new VideoAdmin();
});

// ØªØµØ¯ÙŠØ± Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ù…Ù„ÙØ§Øª Ø£Ø®Ø±Ù‰
window.VideoAdmin = VideoAdmin;
window.videoAdmin = videoAdmin;
